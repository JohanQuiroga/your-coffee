<ion-header>
  <ion-navbar>
    <!-- <button ion-button menuToggle>
      <ion-icon name="menu"></ion-icon>
    </button> -->
    <ion-title>Registrarse</ion-title>
    <ion-buttons start>
      <button ion-button icon-left (click)="prev()"><ion-icon name="arrow-back"></ion-icon> Prev</button>
    </ion-buttons>
    <ion-buttons end>
      <button ion-button icon-right (click)="next()">Next <ion-icon name="arrow-forward"></ion-icon></button>
    </ion-buttons>
  </ion-navbar>
</ion-header>


<ion-content padding>
  <ion-slides #signupSlider pager>

    <ion-slide>

      <p *ngIf="submitAttempt" style="color: #ea6153;">Por favor ingrese todos los datos requeridos</p>

      <ion-list no-lines>

        <form [formGroup]="slideOneForm">

          <ion-list-header text-center text-uppercase>
            Información Personal
          </ion-list-header>

          <ion-item>
            <ion-icon ios="ios-finger-print" md="md-finger-print" item-start></ion-icon>
            <ion-label floating>Número de documento</ion-label>
            <ion-input type="text" formControlName="id"></ion-input>
          </ion-item>

          <ion-item>
            <ion-icon ios="ios-contact" md="md-contact" item-start></ion-icon>
            <ion-label floating>Nombres</ion-label>
            <ion-input type="text" formControlName="nombres"></ion-input>
          </ion-item>

          <ion-item>
            <ion-icon ios="ios-contact" md="md-contact" item-start></ion-icon>
            <ion-label floating>Apellidos</ion-label>
            <ion-input type="text" formControlName="apellidos"></ion-input>
          </ion-item>

          <ion-item>
            <ion-icon ios="ios-mail" md="md-mail" item-start></ion-icon>
            <ion-label floating>Tu e-mail</ion-label>
            <ion-input type="email" formControlName="email"></ion-input>
          </ion-item>

          <ion-item>
            <ion-icon ios="ios-lock" md="md-lock" item-start></ion-icon>
            <ion-label floating>Contraseña</ion-label>
            <ion-input type="password" formControlName="password"></ion-input>
          </ion-item>

          <ion-item>
            <ion-icon ios="ios-checkmark" md="md-checkmark" item-start></ion-icon>
            <ion-label floating>Confirmar contraseña</ion-label>
            <ion-input type="password" formControlName="password_confirmation"></ion-input>
          </ion-item>

          <ion-item>
            <ion-icon ios="ios-call" md="md-call" item-start></ion-icon>
            <ion-label floating>Teléfono</ion-label>
            <ion-input type="number" formControlName="telefono"></ion-input>
          </ion-item>

          <ion-item class="final_item">
            <ion-icon ios="ios-school" md="md-school" item-start></ion-icon>
            <ion-label floating>Nivel de Estudios</ion-label>
            <ion-select formControlName="idNivelEstudios" submitText="OK" cancelText="Cancelar">
              <ion-option *ngFor="let nivelEstudio of fieldsOptions.nivelEstudios" value="{{nivelEstudio.id}}">{{nivelEstudio.tipo}}</ion-option>
            </ion-select>
          </ion-item>

        </form>

      </ion-list>

    </ion-slide>

    <ion-slide>
      <p *ngIf="submitAttempt" style="color: #ea6153;">Por favor ingrese todos los datos necesarios</p>

      <ion-list no-lines>
        <form [formGroup]="slideTwoForm">

          <ion-list-header text-center text-uppercase>
            Ubicación
          </ion-list-header>

          <ion-item>
            <ion-icon ios="ios-compass" md="md-compass" item-start></ion-icon>
            <ion-label floating>Pais</ion-label>
            <ion-select submitText="OK" formControlName="pais" cancelText="Cancelar" (ionChange)="countryChange($event)">
              <ion-option *ngFor="let pais of paises" value="{{pais}}">{{pais}}</ion-option>
            </ion-select>
          </ion-item>

          <ion-item>
            <ion-icon ios="ios-map" md="md-map" item-start></ion-icon>
            <ion-label floating>Departamento</ion-label>
            <ion-select submitText="OK" formControlName="departamento" cancelText="Cancelar" (ionChange)="departmentChange($event)">
              <ion-option *ngFor="let departamento of departamentos" value="{{departamento}}">{{departamento}}</ion-option>
            </ion-select>
          </ion-item>

          <ion-item>
            <ion-icon ios="ios-navigate" md="md-navigate" item-start></ion-icon>
            <ion-label floating>Ciudad</ion-label>
            <ion-select submitText="OK" formControlName="ciudad" cancelText="Cancelar">
              <ion-option *ngFor="let ciudad of ciudades" value="{{ciudad}}">{{ciudad}}</ion-option>
            </ion-select>
          </ion-item>

          <ion-item>
            <ion-icon ios="ios-home" md="md-home" item-start></ion-icon>
            <ion-label floating>Dirección</ion-label>
            <ion-input type="text" formControlName="direccion"></ion-input>
          </ion-item>

          <ion-item>
            <ion-icon ios="ios-information-circle" md="md-information-circle" item-start></ion-icon>
            <ion-label floating>Dirección auxiliar</ion-label>
            <ion-input type="text" formControlName="direccionAuxiliar"></ion-input>
          </ion-item>

          <ion-item class="final_item">
            <ion-icon name="mail" item-start></ion-icon>
            <ion-label floating>Código postal</ion-label>
            <ion-input type="number" formControlName="codigoPostal"></ion-input>
          </ion-item>
        </form>
      </ion-list>

    </ion-slide>

    <ion-slide>
      <p *ngIf="submitAttempt" style="color: #ea6153;">Por favor ingrese todos los datos necesarios</p>

      <ion-list no-lines>
        <form [formGroup]="slideThreeForm">

          <ion-list-header text-center text-uppercase>
            Preferencias del café
          </ion-list-header>

          <ion-item>
            <ion-icon ios="ios-refresh-circle" md="md-refresh-circle" item-start></ion-icon>
            <ion-label floating>Frecuencia de compra</ion-label>
            <ion-select submitText="OK" formControlName="idFrecuenciaCompraCafe" cancelText="Cancelar">
              <ion-option *ngFor="let frecuencia of fieldsOptions.frecuenciaCompraCafe" value="{{frecuencia.id}}">{{frecuencia.tipo}}</ion-option>
            </ion-select>
          </ion-item>

          <ng-template ngFor let-attribute let-l="last" [ngForOf]="fieldsOptions.attributes">
              <ion-item [ngClass]="l ? 'final_item' : ''">
                <ion-icon ios="ios-checkmark" md="md-checkmark" item-start></ion-icon>
                <ion-label floating>{{parse(attribute.nombreAtributo)}}</ion-label>

                <!-- <div *ngIf="!attribute.opciones; then Select else Input"></div> -->

                <ion-select *ngIf="attribute.opciones; else Input" [ngModelOptions]="{standalone: true}" [(ngModel)]="user[attribute.nombreAtributo]" submitText="OK" cancelText="Cancelar">
                  <ion-option *ngFor="let option of attribute.opciones" value="{{option}}">{{option}}</ion-option>
                </ion-select>

                <ng-template #Input>
                  <ion-input type="text" [ngModelOptions]="{standalone: true}" [(ngModel)]="user[attribute.nombreAtributo]"></ion-input>
                </ng-template>

              </ion-item>
          </ng-template>
          <button ion-button full color="primary" (click)="save()">Registrarse</button>

        </form>
      </ion-list>

    </ion-slide>

  </ion-slides>

</ion-content>
